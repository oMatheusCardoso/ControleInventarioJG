<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <title>Brindes</title>
  
  </head>

  <link rel="stylesheet" href="./css/css-global.css"/>
  <link rel="stylesheet" href="./css/brindes.css"/>


  <body>
    <a href="home.html"><img id="ConteudoLogo" src="logo.png" alt="Logo Jovens Gênios" ></a>

    <button type="button" class="solid" id="sair">Sair</button>
    <a href="home.html"><button type="button" class="solid" id="backToHome">Voltar</button></a>
    <a href="add-db-brindes.html"><button type="button" class="solid" id="AddBrindes">Adicionar Itens ao Estoque</button></a>
    <h3>Controle de Brindes</h3> 

    <h4>Insira o nome do Item</h4>
    <input id="findID" type="text" />
    <button id="find" class="solid">Procurar</button>
    

    <div id="dadosItens">
    

    <h1>Lista dos Itens</h1>

    <Ol id="ListaItem"></Ol>

<!-- 
    <h1>Dados dos Itens</h1>

    <h3 id="Item" type="text"></h3>
    <img id="Imagem" src="" alt="Imagem do Item"> 
    <h3 id="Tipo" type="text"></h3>
    <h3 id="Material" type="text"></h3>
    <h3 id="Arte" type="text"></h3>
    <h3 id="Quantidade" type="text"></h3>
    <h3 id="PrecoCompra" type="text"></h3>
    <h3 id="CustoProduto" type="text"></h3>
    <h3 id="PrecoVenda" type="text"></h3>
    <h3 id="DataCompra" type="text"></h3>
    <h3 id="Obs" type="text"></h3>
    <a id= "ImagemNotaFiscal" target="_blank" href=""><button>Visualizar Nota Fiscal</button></a> -->

    </div>

    <script src="scan.js"></script>
    <script type="module" async>
      import {
        auth,
        onAuthStateChanged,
        dbref,
        FindDataByType,
        orderByChild
      } from "./libs/firebase/index.js";

      import { 
        getMonths,
        calc,
        formatCurrency,
      } from "./utils/calcDepreciation.js";

      function redirectUser() {
        onAuthStateChanged(auth, (user) => {
          if (user) {
            console.log(user);
          } else {
            logout();
          }
        });
      }
      // redirectUser();  //DESATIVADO PARA MELHOR TESTE

      var Tipo = document.querySelector("#Tipo");
      var Material = document.querySelector("#Material");
      var Arte = document.querySelector("#Arte");
      var Quantidade = document.querySelector("#Quantidade");
      var DataCompra = document.querySelector("#DataCompra");
      var ImagemNotaFiscal = document.querySelector("#ImagemNotaFiscal");
      var Obs = document.querySelector("#Obs");
      var find = document.querySelector("#find");
      var DataCompra = document.querySelector("#DataCompra");
      var Imagem = document.querySelector("#Imagem");	
      var PrecoCompra = document.querySelector("#PrecoCompra");	
      var CustoProduto = document.querySelector("#CustoProduto");	
      var PrecoVenda = document.querySelector("#PrecoVenda");	
      var ListaItem =  document.querySelector("#ListaItem");


      function setData(item) {
      
        console.log(item);
        // getMonths(item.DataCompra);
        // calc(item.ValorCompra, item.DataCompra);

        // Tipo.innerHTML = "Tipo: " + item.Tipo;
        // Imagem.innerHTML = "Imagem: " + item.Imagem;        
        // Material.innerHTML = "Material: " + item.Material;
        // Arte.innerHTML = "Arte: " + item.Arte;
        // Quantidade.innerHTML = "Quantidade: " + item.Quantidade;
        // PrecoCompra.innerHTML = "Preço de Compra: " + item.PrecoCompra;
        // CustoProduto.innerHTML = "Custo do Produto Finalizado: " + item.CustoProduto;
        // PrecoVenda.innerHTML = "Valor de Venda: " + item.PrecoVenda;
        // // DataCompra.innerHTML = "DataCompra: " + item.DataCompra;
        // // ImagemNotaFiscal.innerHTML ="NotaFiscal: " + item.VisuNota;
        // Obs.innerHTML = "Obs: " + item.Obs;
        // ImagemNotaFiscal.setAttribute("href", item.ImagemNotaFiscal);
        // Imagem.setAttribute ("src", item.Imagem);

      
        // const transactions = item.map(function(obj){

        //   return Object.keys(obj).map(function(key){
        //     return obj[key];
        //   })
        //   Listagem(transactions);

        // });


        console.log(transactions);

        function Listagem(transactions){

          transactions.forEach((transactions) => {
            
            const li = document.createElement('li');
            li.classList.add(transactions.Tipo);          
            ListaItem.appendChild(li);

            const ItemDB = document.createElement('p')
            ItemDB.innerHTML = "Item: " + transactions.Item
            li.appendChild(ItemDB);
            

          });
        }


        if ((ImagemNotaFiscal || Imagem ) != null) {
          
            Imagem.style.display="flex";
            ImagemNotaFiscal.style.display="flex"; // Verificar se terá no app final, caso não tenha, retirar.

        };

        Listagem();
      }

      find.addEventListener("click", async () => {
        await FindDataByType(findID.value, "Brindes", setData);
        // usar loop para o set data   
        
      });

      
      
      function logout() {
      auth.signOut().then(() => {
          window.location.href = "index.html";
      }).catch(() => {
          alert('Erro ao fazer logout!')
    });
}

      
      sair.addEventListener("click", logout);
    </script>
  </body>
</html>
